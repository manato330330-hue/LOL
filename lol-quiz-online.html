<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LoLæ—©æŠ¼ã—ã‚¯ã‚¤ã‚º - ã‚ªãƒ³ãƒ©ã‚¤ãƒ³å¯¾æˆ¦</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght:700;900&family=Noto+Sans+JP:wght@400;700&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --gold: #C89B3C;
            --dark-blue: #0A1428;
            --blue: #0BC4E2;
            --purple: #A855F7;
            --red: #EF4444;
            --green: #10B981;
            --orange: #F97316;
        }

        body {
            font-family: 'Noto Sans JP', sans-serif;
            background: linear-gradient(135deg, #0A1428 0%, #1a2744 50%, #0A1428 100%);
            color: white;
            min-height: 100vh;
            overflow-x: hidden;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20% 80%, rgba(168, 85, 247, 0.15) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(11, 196, 226, 0.15) 0%, transparent 50%);
            pointer-events: none;
            z-index: 0;
        }

        .container {
            max-width: 100vw;
            min-height: 100vh;
            padding: 1rem;
            position: relative;
            z-index: 1;
        }

        h1 {
            font-family: 'Orbitron', sans-serif;
            font-size: clamp(1.5rem, 4vw, 2rem);
            text-align: center;
            margin-bottom: 0.3rem;
            background: linear-gradient(135deg, var(--gold) 0%, var(--blue) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .subtitle {
            text-align: center;
            color: var(--blue);
            font-size: clamp(0.8rem, 2vw, 1rem);
            margin-bottom: 1rem;
            letter-spacing: 1px;
        }

        .screen {
            display: none;
        }

        .screen.active {
            display: block;
        }

        .setup-card, .lobby-card {
            background: rgba(26, 39, 68, 0.8);
            border: 2px solid var(--gold);
            border-radius: 15px;
            padding: 1.5rem;
            backdrop-filter: blur(10px);
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
            max-width: 700px;
            margin: 0 auto;
            max-height: 85vh;
            overflow-y: auto;
        }

        .input-group {
            margin-bottom: 1rem;
        }

        label {
            display: block;
            margin-bottom: 0.4rem;
            color: var(--gold);
            font-weight: 700;
            font-size: 0.9rem;
        }

        input, select {
            width: 100%;
            padding: 0.6rem;
            background: rgba(10, 20, 40, 0.7);
            border: 2px solid var(--blue);
            border-radius: 8px;
            color: white;
            font-size: 0.9rem;
        }

        input:focus, select:focus {
            outline: none;
            border-color: var(--gold);
        }

        .btn {
            padding: 0.8rem 2rem;
            background: linear-gradient(135deg, var(--gold) 0%, #d4af37 100%);
            border: none;
            border-radius: 10px;
            color: var(--dark-blue);
            font-size: 1rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            text-transform: uppercase;
            letter-spacing: 1px;
            font-family: 'Orbitron', sans-serif;
        }

        .btn:hover {
            transform: translateY(-2px);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .btn-secondary {
            background: linear-gradient(135deg, var(--blue) 0%, var(--purple) 100%);
            color: white;
        }

        .category-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 0.8rem;
            margin-top: 0.8rem;
        }

        .category-option {
            padding: 0.8rem;
            background: rgba(10, 20, 40, 0.7);
            border: 2px solid var(--blue);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
            font-size: 0.85rem;
        }

        .category-option:hover {
            transform: translateY(-2px);
            border-color: var(--gold);
        }

        .category-option.selected {
            background: linear-gradient(135deg, var(--gold) 0%, #d4af37 100%);
            border-color: var(--gold);
            color: var(--dark-blue);
        }

        .quiz-layout {
            display: grid;
            grid-template-columns: 1fr 280px;
            gap: 1rem;
            height: calc(100vh - 100px);
            max-height: calc(100vh - 100px);
        }

        .quiz-main {
            display: flex;
            flex-direction: column;
            gap: 0.8rem;
            min-height: 0;
        }

        .quiz-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: rgba(26, 39, 68, 0.8);
            border: 2px solid var(--gold);
            border-radius: 10px;
            padding: 0.8rem 1rem;
            flex-shrink: 0;
        }

        .round-info {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.1rem;
            color: var(--gold);
        }

        .timer {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.5rem;
            color: var(--blue);
            min-width: 60px;
            text-align: center;
        }

        .timer.warning {
            color: var(--red);
            animation: pulse 0.5s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        .question-section {
            flex: 1;
            background: rgba(26, 39, 68, 0.9);
            border: 2px solid var(--purple);
            border-radius: 15px;
            padding: 1.5rem;
            display: flex;
            flex-direction: column;
            gap: 1rem;
            overflow-y: auto;
            min-height: 0;
        }

        .question-image {
            max-width: 100%;
            max-height: 400px;
            object-fit: cover;
            border: 3px solid var(--gold);
            border-radius: 10px;
            margin: 0 auto;
            display: block;
        }

        .question-text {
            font-size: clamp(1.2rem, 3vw, 1.5rem);
            font-weight: 700;
            text-align: center;
            line-height: 1.5;
        }

        .buzzer-section {
            text-align: center;
        }

        .buzzer-btn {
            padding: 1.5rem 3rem;
            background: linear-gradient(135deg, var(--orange) 0%, var(--red) 100%);
            border: 3px solid var(--gold);
            border-radius: 15px;
            color: white;
            font-size: 1.5rem;
            font-weight: 700;
            cursor: pointer;
            font-family: 'Orbitron', sans-serif;
            transition: all 0.3s;
            text-transform: uppercase;
        }

        .buzzer-btn:hover {
            transform: scale(1.05);
        }

        .buzzer-btn:disabled {
            opacity: 0.3;
            cursor: not-allowed;
            transform: scale(1);
        }

        .answer-section {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .answer-input-area {
            background: rgba(10, 20, 40, 0.5);
            border: 2px solid var(--gold);
            border-radius: 10px;
            padding: 1.5rem;
            min-height: 80px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--gold);
            text-align: center;
            word-break: break-all;
        }

        .choice-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 0.8rem;
        }

        .choice-btn {
            padding: 1.2rem;
            background: linear-gradient(135deg, var(--blue) 0%, var(--purple) 100%);
            border: 3px solid transparent;
            border-radius: 10px;
            color: white;
            font-size: 1.3rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
        }

        .choice-btn:hover:not(:disabled) {
            transform: scale(1.05);
            border-color: var(--gold);
        }

        .choice-btn:disabled {
            opacity: 0.3;
            cursor: not-allowed;
            transform: scale(1);
        }

        .sidebar {
            display: flex;
            flex-direction: column;
            gap: 0.8rem;
            overflow-y: auto;
            min-height: 0;
        }

        .scoreboard {
            background: rgba(26, 39, 68, 0.9);
            border: 2px solid var(--gold);
            border-radius: 10px;
            padding: 1rem;
            flex-shrink: 0;
        }

        .scoreboard h3 {
            font-family: 'Orbitron', sans-serif;
            color: var(--gold);
            margin-bottom: 0.8rem;
            text-align: center;
            font-size: 1.1rem;
        }

        .score-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.6rem;
            margin-bottom: 0.4rem;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            border-left: 3px solid var(--blue);
        }

        .score-item.first {
            border-left-color: var(--gold);
            background: rgba(200, 155, 60, 0.1);
        }

        .score-name {
            font-weight: 700;
            font-size: 0.9rem;
        }

        .score-points {
            color: var(--gold);
            font-family: 'Orbitron', sans-serif;
            font-size: 1rem;
            font-weight: 700;
        }

        .progress-box {
            background: rgba(26, 39, 68, 0.9);
            border: 2px solid var(--purple);
            border-radius: 10px;
            padding: 1rem;
            flex-shrink: 0;
        }

        .progress-box h3 {
            font-family: 'Orbitron', sans-serif;
            color: var(--purple);
            margin-bottom: 0.8rem;
            text-align: center;
            font-size: 1rem;
        }

        .progress-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0.5rem;
            margin-bottom: 0.4rem;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 6px;
            font-size: 0.85rem;
        }

        .progress-item.answered {
            border-left: 3px solid var(--green);
        }

        .progress-item.wrong {
            border-left: 3px solid var(--red);
        }

        .progress-name {
            font-weight: 700;
        }

        .progress-badge {
            padding: 0.2rem 0.5rem;
            border-radius: 8px;
            font-size: 0.75rem;
            font-weight: 700;
        }

        .progress-badge.correct {
            background: var(--green);
            color: white;
        }

        .progress-badge.incorrect {
            background: var(--red);
            color: white;
        }

        .progress-badge.first {
            background: var(--gold);
            color: var(--dark-blue);
        }

        .mistakes-info {
            background: rgba(239, 68, 68, 0.2);
            border: 1px solid var(--red);
            border-radius: 6px;
            padding: 0.4rem;
            text-align: center;
            margin-top: 0.3rem;
            font-size: 0.75rem;
        }

        .connection-status {
            position: fixed;
            top: 0.5rem;
            right: 0.5rem;
            background: rgba(0, 0, 0, 0.8);
            padding: 0.4rem 0.8rem;
            border-radius: 15px;
            display: flex;
            align-items: center;
            gap: 0.4rem;
            z-index: 100;
            font-size: 0.8rem;
        }

        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--green);
        }

        .status-dot.disconnected {
            background: var(--red);
        }

        .results-card {
            background: rgba(26, 39, 68, 0.9);
            border: 3px solid var(--gold);
            border-radius: 15px;
            padding: 2rem;
            text-align: center;
            max-width: 600px;
            margin: 0 auto;
        }

        .trophy {
            font-size: 4rem;
            margin-bottom: 0.8rem;
        }

        .winner-name {
            font-family: 'Orbitron', sans-serif;
            font-size: 2rem;
            color: var(--gold);
            margin-bottom: 1rem;
        }

        .results-actions {
            display: flex;
            gap: 1rem;
            justify-content: center;
            margin-top: 1.5rem;
        }
    </style>
</head>
<body>
    <div class="connection-status">
        <div class="status-dot" id="statusDot"></div>
        <span id="statusText">æ¥ç¶šä¸­</span>
    </div>

    <div class="container">
        <h1>LoLæ—©æŠ¼ã—ã‚¯ã‚¤ã‚º</h1>
        <p class="subtitle">League of Legends - ã‚ªãƒ³ãƒ©ã‚¤ãƒ³å¯¾æˆ¦</p>

        <div id="homeScreen" class="screen active">
            <div class="setup-card">
                <div class="input-group">
                    <label>ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼å</label>
                    <input type="text" id="playerName" placeholder="ã‚ãªãŸã®åå‰ã‚’å…¥åŠ›" maxlength="20">
                </div>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 0.8rem;">
                    <button class="btn" id="createRoomBtn">ãƒ«ãƒ¼ãƒ ã‚’ä½œæˆ</button>
                    <button class="btn btn-secondary" id="joinRoomBtn">ãƒ«ãƒ¼ãƒ ã«å‚åŠ </button>
                </div>
            </div>
        </div>

        <div id="joinScreen" class="screen">
            <div class="setup-card">
                <div class="input-group">
                    <label>ãƒ«ãƒ¼ãƒ ã‚³ãƒ¼ãƒ‰</label>
                    <input type="text" id="roomCodeInput" placeholder="6æ¡ã®ã‚³ãƒ¼ãƒ‰ã‚’å…¥åŠ›" maxlength="6" style="text-transform: uppercase;">
                </div>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 0.8rem;">
                    <button class="btn btn-secondary" id="backToHomeBtn">æˆ»ã‚‹</button>
                    <button class="btn" id="joinBtn">å‚åŠ </button>
                </div>
            </div>
        </div>

        <div id="lobbyScreen" class="screen">
            <div class="lobby-card">
                <div style="background: rgba(10, 20, 40, 0.9); border: 2px solid var(--gold); border-radius: 10px; padding: 1rem; text-align: center; margin-bottom: 1rem;">
                    <div style="color: var(--blue); font-size: 0.9rem; margin-bottom: 0.3rem;">ãƒ«ãƒ¼ãƒ ã‚³ãƒ¼ãƒ‰</div>
                    <div style="font-family: 'Orbitron', sans-serif; font-size: 2rem; color: var(--gold); letter-spacing: 6px; margin: 0.3rem 0;" id="roomCode">------</div>
                    <button id="copyCodeBtn" style="padding: 0.5rem 1.2rem; background: var(--blue); border: none; border-radius: 8px; color: white; font-weight: 700; cursor: pointer; font-size: 0.85rem;">ğŸ“‹ ã‚³ãƒ”ãƒ¼</button>
                </div>

                <div class="input-group" id="hostSettings">
                    <label>å‡ºé¡Œç¯„å›²è¨­å®šï¼ˆè¤‡æ•°é¸æŠå¯ï¼‰</label>
                    <div class="category-grid" id="categoryGrid">
                        <div class="category-option selected" data-category="champion">ğŸ­ ãƒãƒ£ãƒ³ãƒ”ã‚ªãƒ³å</div>
                        <div class="category-option" data-category="skill">âš”ï¸ ã‚¹ã‚­ãƒ«åŠ¹æœ</div>
                        <div class="category-option" data-category="lore">ğŸ“– ã‚¹ãƒˆãƒ¼ãƒªãƒ¼</div>
                        <div class="category-option" data-category="combo">ğŸ¯ ã‚³ãƒ³ãƒœ</div>
                        <div class="category-option" data-category="cooldown">â±ï¸ ã‚¯ãƒ¼ãƒ«ãƒ€ã‚¦ãƒ³</div>
                        <div class="category-option" data-category="proplay">ğŸ† ãƒ—ãƒ­ã‚·ãƒ¼ãƒ³</div>
                    </div>
                </div>

                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 0.8rem;" id="hostSettings2">
                    <div class="input-group">
                        <label>å‹åˆ©æ¡ä»¶</label>
                        <select id="winPoints">
                            <option value="5">å…ˆã«5ãƒã‚¤ãƒ³ãƒˆ</option>
                            <option value="10" selected>å…ˆã«10ãƒã‚¤ãƒ³ãƒˆ</option>
                            <option value="15">å…ˆã«15ãƒã‚¤ãƒ³ãƒˆ</option>
                            <option value="20">å…ˆã«20ãƒã‚¤ãƒ³ãƒˆ</option>
                            <option value="30">å…ˆã«30ãƒã‚¤ãƒ³ãƒˆ</option>
                        </select>
                    </div>
                    <div class="input-group">
                        <label>ãŠæ‰‹ä»˜ãè¨±å®¹</label>
                        <select id="mistakesAllowed">
                            <option value="1">1å›ã¾ã§</option>
                            <option value="2" selected>2å›ã¾ã§</option>
                            <option value="3">3å›ã¾ã§</option>
                            <option value="5">5å›ã¾ã§</option>
                            <option value="999">ç„¡åˆ¶é™</option>
                        </select>
                    </div>
                </div>

                <div class="input-group">
                    <label>å‚åŠ ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼</label>
                    <div style="background: rgba(10, 20, 40, 0.7); border-radius: 10px; padding: 1rem;" id="playersList"></div>
                </div>

                <button class="btn" id="startGameBtn" style="display: block; margin: 1rem auto 0; width: 100%;">ã‚²ãƒ¼ãƒ é–‹å§‹</button>
            </div>
        </div>

        <div id="quizScreen" class="screen">
            <div class="quiz-layout">
                <div class="quiz-main">
                    <div class="quiz-header">
                        <div class="round-info">
                            å•é¡Œ <span id="currentRound">1</span>
                        </div>
                        <div class="timer" id="timer">30</div>
                    </div>

                    <div class="question-section">
                        <img id="questionImage" class="question-image" style="display: none;">
                        <div class="question-text" id="questionText"></div>
                        
                        <div id="buzzerSection" class="buzzer-section">
                            <button class="buzzer-btn" id="buzzerBtn">å›ç­”ã™ã‚‹</button>
                        </div>

                        <div id="answerSection" class="answer-section" style="display: none;">
                            <div class="answer-input-area" id="answerDisplay"></div>
                            <div class="choice-grid" id="choiceGrid"></div>
                        </div>
                    </div>
                </div>

                <div class="sidebar">
                    <div class="scoreboard">
                        <h3>ã‚¹ã‚³ã‚¢ãƒœãƒ¼ãƒ‰</h3>
                        <div id="scoreList"></div>
                    </div>

                    <div class="progress-box">
                        <h3>å›ç­”çŠ¶æ³</h3>
                        <div id="answerProgress"></div>
                    </div>
                </div>
            </div>
        </div>

        <div id="resultsScreen" class="screen">
            <div class="results-card">
                <div class="trophy">ğŸ†</div>
                <div class="winner-name" id="winnerName"></div>
                <div id="finalScores" style="margin: 1.5rem 0;"></div>
                <div class="results-actions">
                    <button class="btn btn-secondary" id="continueBtn">ç¶šã‘ã‚‹</button>
                    <button class="btn" id="endBtn">çµ‚äº†</button>
                </div>
            </div>
        </div>
    </div>

    <script>
(function() {
    'use strict';

    const AudioContext = window.AudioContext || window.webkitAudioContext;
    const audioCtx = new AudioContext();

    function playSound(freq, dur, type) {
        if (audioCtx.state === 'suspended') audioCtx.resume();
        const osc = audioCtx.createOscillator();
        const gain = audioCtx.createGain();
        osc.connect(gain);
        gain.connect(audioCtx.destination);
        osc.frequency.value = freq;
        osc.type = type || 'sine';
        gain.gain.setValueAtTime(0.3, audioCtx.currentTime);
        gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + dur);
        osc.start(audioCtx.currentTime);
        osc.stop(audioCtx.currentTime + dur);
    }

    function playCorrect() {
        playSound(523.25, 0.15);
        setTimeout(function() { playSound(659.25, 0.15); }, 150);
        setTimeout(function() { playSound(783.99, 0.3); }, 300);
    }

    function playWrong() {
        playSound(200, 0.5, 'square');
    }

    function playClick() {
        playSound(600, 0.1);
    }

    const championData = [
        {id: "Aatrox", jp: "ãˆã„ã¨ã‚ã£ãã™"}, {id: "Ahri", jp: "ã‚ãƒ¼ã‚Š"}, {id: "Akali", jp: "ã‚ã‹ã‚Š"},
        {id: "Akshan", jp: "ã‚ãã—ã‚ƒã‚“"}, {id: "Alistar", jp: "ã‚ã‚Šã™ãŸãƒ¼"}, {id: "Amumu", jp: "ã‚ã‚€ã‚€"},
        {id: "Anivia", jp: "ã‚ã«ã†ã‚›ãƒã‚"}, {id: "Annie", jp: "ã‚ã«ãƒ¼"}, {id: "Aphelios", jp: "ã‚ãµã‡ã‚ŠãŠã™"},
        {id: "Ashe", jp: "ã‚ã£ã—ã‚…"}, {id: "AurelionSol", jp: "ãŠã‚Œã‚ŠãŠã‚“ãã‚‹"}, {id: "Azir", jp: "ã‚ã˜ãƒ¼ã‚‹"},
        {id: "Bard", jp: "ã°ãƒ¼ã©"}, {id: "Belveth", jp: "ã¹ã‚‹ã†ã‚›ã‡ã™"}, {id: "Blitzcrank", jp: "ã¶ã‚Šã£ã¤ãã‚‰ã‚“ã"},
        {id: "Brand", jp: "ã¶ã‚‰ã‚“ã©"}, {id: "Braum", jp: "ã¶ã‚‰ã†ã‚€"}, {id: "Caitlyn", jp: "ã‘ã„ã¨ã‚Šã‚“"},
        {id: "Camille", jp: "ã‹ã¿ãƒ¼ã‚‹"}, {id: "Cassiopeia", jp: "ã‹ã—ãŠãºã‚"}, {id: "Chogath", jp: "ã¡ã‚‡ãŒã™"},
        {id: "Corki", jp: "ã“ãƒ¼ã"}, {id: "Darius", jp: "ã ã‚Šã†ã™"}, {id: "Diana", jp: "ã ã„ã‚ãª"},
        {id: "Draven", jp: "ã©ã‚Œã„ã†ã‚›ã‚“"}, {id: "DrMundo", jp: "ã©ããŸãƒ¼ã‚€ã‚“ã©"}, {id: "Ekko", jp: "ãˆã“ãƒ¼"},
        {id: "Elise", jp: "ãˆã‚Šã™"}, {id: "Evelynn", jp: "ã„ã†ã‚›ã‚Šã‚“"}, {id: "Ezreal", jp: "ãˆãšã‚Šã‚ã‚‹"},
        {id: "Fiddlesticks", jp: "ãµãƒã©ã‚‹ã™ã¦ãƒã£ãã™"}, {id: "Fiora", jp: "ãµãƒãŠã‚‰"}, {id: "Fizz", jp: "ãµãƒãš"},
        {id: "Galio", jp: "ãŒã‚ŠãŠ"}, {id: "Gangplank", jp: "ãŒã‚“ã·ã‚‰ã‚“ã"}, {id: "Garen", jp: "ãŒã‚Œã‚“"},
        {id: "Gnar", jp: "ãªãƒ¼"}, {id: "Gragas", jp: "ãã‚‰ãŒã™"}, {id: "Graves", jp: "ãã‚Œã„ã†ã‚›ã™"},
        {id: "Gwen", jp: "ãã†ã‡ã‚“"}, {id: "Hecarim", jp: "ã¸ã‹ã‚Šã‚€"}, {id: "Heimerdinger", jp: "ã¯ã„ã¾ãƒ¼ã§ãƒã‚“ãŒãƒ¼"},
        {id: "Illaoi", jp: "ã„ã‚‰ãŠã„"}, {id: "Irelia", jp: "ã„ã‚Œã‚Šã‚"}, {id: "Ivern", jp: "ã‚ã„ã†ã‚›ããƒ¼ã‚“"},
        {id: "Janna", jp: "ã˜ã‚ƒã‚“ãª"}, {id: "JarvanIV", jp: "ã˜ã‚ƒãƒ¼ã†ã‚›ãã‚“ãµã‰ãƒ¼"}, {id: "Jax", jp: "ã˜ã‚ƒã£ãã™"},
        {id: "Jayce", jp: "ã˜ã‡ã„ã™"}, {id: "Jhin", jp: "ã˜ã‚“"}, {id: "Jinx", jp: "ã˜ã‚“ãã™"},
        {id: "Kaisa", jp: "ã‹ã„ã•"}, {id: "Kalista", jp: "ã‹ã‚Šã™ãŸ"}, {id: "Karma", jp: "ã‹ã‚‹ã¾"},
        {id: "Karthus", jp: "ã‹ãƒ¼ã•ã™"}, {id: "Kassadin", jp: "ã‹ã•ã§ãƒã‚“"}, {id: "Katarina", jp: "ã‹ãŸã‚Šãª"},
        {id: "Kayle", jp: "ã‘ã„ã‚‹"}, {id: "Kayn", jp: "ã‘ã„ã‚“"}, {id: "Kennen", jp: "ã‘ã­ã‚“"},
        {id: "Khazix", jp: "ã‹ã˜ã£ãã™"}, {id: "Kindred", jp: "ãã‚“ã©ã‚Œã£ã©"}, {id: "Kled", jp: "ãã‚Œã£ã©"},
        {id: "KogMaw", jp: "ã“ãã¾ã†"}, {id: "KSante", jp: "ã‘ã•ã‚“ã¦"}, {id: "Leblanc", jp: "ã‚‹ã¶ã‚‰ã‚“"},
        {id: "LeeSin", jp: "ã‚Šãƒ¼ã—ã‚“"}, {id: "Leona", jp: "ã‚ŒãŠãª"}, {id: "Lillia", jp: "ã‚Šã‚Šã‚"},
        {id: "Lissandra", jp: "ã‚Šã•ã‚“ã©ã‚‰"}, {id: "Lucian", jp: "ã‚‹ã—ã‚ã‚“"}, {id: "Lulu", jp: "ã‚‹ã‚‹"},
        {id: "Lux", jp: "ã‚‹ãã™"}, {id: "Malphite", jp: "ã¾ã‚‹ãµãã„ã¨"}, {id: "Malzahar", jp: "ã¾ã‚‹ã–ã¯ãƒ¼ã‚‹"},
        {id: "Maokai", jp: "ã¾ãŠã‹ã„"}, {id: "MasterYi", jp: "ã¾ã™ãŸãƒ¼ã„ãƒ¼"}, {id: "Milio", jp: "ã¿ã‚ŠãŠ"},
        {id: "MissFortune", jp: "ã¿ã™ãµã‰ãƒ¼ã¡ã‚…ã‚“"}, {id: "Mordekaiser", jp: "ã‚‚ã‚‹ã§ã‹ã„ã–ãƒ¼"}, {id: "Morgana", jp: "ã‚‚ã‚‹ãŒãª"},
        {id: "Naafiri", jp: "ãªãƒ¼ãµãƒã‚Š"}, {id: "Nami", jp: "ãªã¿"}, {id: "Nasus", jp: "ãªã•ã™"},
        {id: "Nautilus", jp: "ã®ãƒ¼ã¡ã‚‰ã™"}, {id: "Neeko", jp: "ã«ãƒ¼ã“"}, {id: "Nidalee", jp: "ã«ã ã‚Šãƒ¼"},
        {id: "Nilah", jp: "ã«ãƒ¼ã‚‰"}, {id: "Nocturne", jp: "ã®ããŸãƒ¼ã‚“"}, {id: "Nunu", jp: "ã¬ã¬"},
        {id: "Olaf", jp: "ãŠã‚‰ãµ"}, {id: "Orianna", jp: "ãŠã‚Šã‚ãª"}, {id: "Ornn", jp: "ãŠãƒ¼ã‚“"},
        {id: "Pantheon", jp: "ã±ã‚“ã¦ãŠã‚“"}, {id: "Poppy", jp: "ã½ã£ã´ãƒ¼"}, {id: "Pyke", jp: "ã±ã„ã"},
        {id: "Qiyana", jp: "ãã‚ãª"}, {id: "Quinn", jp: "ãã„ã‚“"}, {id: "Rakan", jp: "ã‚‰ã‹ã‚“"},
        {id: "Rammus", jp: "ã‚‰ã‚€ã™"}, {id: "RekSai", jp: "ã‚Œãã•ã„"}, {id: "Rell", jp: "ã‚Œã‚‹"},
        {id: "Renata", jp: "ã‚Œãªãƒ¼ãŸ"}, {id: "Renekton", jp: "ã‚Œã­ãã¨ã‚“"}, {id: "Rengar", jp: "ã‚Œã‚“ãŒãƒ¼"},
        {id: "Riven", jp: "ã‚Šã†ã‚›ã‡ã‚“"}, {id: "Rumble", jp: "ã‚‰ã‚“ã¶ã‚‹"}, {id: "Ryze", jp: "ã‚‰ã„ãš"},
        {id: "Samira", jp: "ã•ã¿ãƒ¼ã‚‰"}, {id: "Sejuani", jp: "ã›ã˜ã‚…ã‚ã«"}, {id: "Senna", jp: "ã›ãª"},
        {id: "Seraphine", jp: "ã›ã‚‰ãµãƒãƒ¼ã‚“"}, {id: "Sett", jp: "ã›ã£ã¨"}, {id: "Shaco", jp: "ã—ã‚ƒã“"},
        {id: "Shen", jp: "ã—ã‡ã‚“"}, {id: "Shyvana", jp: "ã—ã†ã‚›ããª"}, {id: "Singed", jp: "ã—ã‚“ã˜ã©"},
        {id: "Sion", jp: "ã•ã„ãŠã‚“"}, {id: "Sivir", jp: "ã—ã†ã‚›ãƒã‚"}, {id: "Skarner", jp: "ã™ã‹ãƒ¼ãªãƒ¼"},
        {id: "Sona", jp: "ããª"}, {id: "Soraka", jp: "ãã‚‰ã‹"}, {id: "Swain", jp: "ã™ã†ã‡ã„ã‚“"},
        {id: "Sylas", jp: "ã•ã„ã‚‰ã™"}, {id: "Syndra", jp: "ã—ã‚“ã©ã‚‰"}, {id: "TahmKench", jp: "ãŸã‚€ã‘ã‚“ã¡"},
        {id: "Taliyah", jp: "ãŸã‚Šã‚„"}, {id: "Talon", jp: "ãŸã‚ã‚“"}, {id: "Taric", jp: "ãŸã‚Šã£ã"},
        {id: "Teemo", jp: "ã¦ãƒãƒ¼ã‚‚"}, {id: "Thresh", jp: "ã™ã‚Œã£ã—ã‚…"}, {id: "Tristana", jp: "ã¨ã‚Šã™ãŸãª"},
        {id: "Trundle", jp: "ã¨ã‚‰ã‚“ã©ã‚‹"}, {id: "Tryndamere", jp: "ã¨ã‚Šã‚“ã ã‚ã‚"}, {id: "TwistedFate", jp: "ã¤ã„ã™ã¦ã£ã©ãµã‡ã„ã¨"},
        {id: "Twitch", jp: "ã¨ã…ã„ã£ã¡"}, {id: "Udyr", jp: "ã†ã§ãƒã‚"}, {id: "Urgot", jp: "ã‚ãƒ¼ã”ã£ã¨"},
        {id: "Varus", jp: "ã†ã‚›ãã‚‹ã™"}, {id: "Vayne", jp: "ã†ã‚›ã‡ã„ã‚“"}, {id: "Veigar", jp: "ã†ã‚›ã‡ã„ãŒãƒ¼"},
        {id: "Velkoz", jp: "ã†ã‚›ã‡ã‚‹ã“ãš"}, {id: "Vex", jp: "ã†ã‚›ã‡ã£ãã™"}, {id: "Vi", jp: "ã†ã‚›ãã„"},
        {id: "Viego", jp: "ã†ã‚›ãƒãˆã”"}, {id: "Viktor", jp: "ã†ã‚›ãƒããŸãƒ¼"}, {id: "Vladimir", jp: "ã†ã‚›ã‚‰ã§ãƒã¿ãƒ¼ã‚‹"},
        {id: "Volibear", jp: "ã†ã‚›ã‰ã‚Šã¹ã‚"}, {id: "Warwick", jp: "ã‚ãƒ¼ã†ãƒã£ã"}, {id: "Wukong", jp: "ã†ãƒ¼ã“ã‚“"},
        {id: "Xayah", jp: "ã–ã‚„"}, {id: "Xerath", jp: "ãœã‚‰ã™"}, {id: "XinZhao", jp: "ã—ã‚“ã˜ã‚ƒãŠ"},
        {id: "Yasuo", jp: "ã‚„ã™ãŠ"}, {id: "Yone", jp: "ã‚ˆã­"}, {id: "Yorick", jp: "ã‚ˆã‚Šã£ã"},
        {id: "Yuumi", jp: "ã‚†ãƒ¼ã¿"}, {id: "Zac", jp: "ã–ã£ã"}, {id: "Zed", jp: "ãœã©"},
        {id: "Zeri", jp: "ãœã‚Š"}, {id: "Ziggs", jp: "ã˜ãã™"}, {id: "Zilean", jp: "ã˜ã‚Šã‚ã‚“"},
        {id: "Zoe", jp: "ããƒ¼ã„"}, {id: "Zyra", jp: "ã–ã„ã‚‰"}
    ];

    const questionDB = {
        champion: [],
        skill: [
            {q: "ãƒ¤ã‚¹ã‚ªã®Qã‚¹ã‚­ãƒ«ã®åŠ¹æœã¯", a: "ã®ã£ãã‚ã£ã·", choices: ["ã®ã£ãã‚ã£ã·", "ã™ãŸã‚“", "ã™ã­ã‚", "ã™ã‚ã†"]},
            {q: "ãƒ¬ã‚ªãƒŠã®Qã‚¹ã‚­ãƒ«ã®åŠ¹æœã¯", a: "ã™ãŸã‚“", choices: ["ã™ãŸã‚“", "ã®ã£ãã‚ã£ã·", "ã™ã­ã‚", "ã•ã„ã‚Œã‚“ã™"]},
            {q: "ãƒ¢ãƒ«ã‚¬ãƒŠã®Qã‚¹ã‚­ãƒ«ã®åŠ¹æœã¯", a: "ã™ã­ã‚", choices: ["ã™ã­ã‚", "ã™ãŸã‚“", "ã™ã‚ã†", "ã®ã£ãã‚ã£ã·"]},
            {q: "ã‚¢ãƒƒã‚·ãƒ¥ã®Rã‚¹ã‚­ãƒ«ã®åŠ¹æœã¯", a: "ã™ãŸã‚“", choices: ["ã™ãŸã‚“", "ã™ã­ã‚", "ã™ã‚ã†", "ã•ã„ã‚Œã‚“ã™"]},
            {q: "ãƒãƒ«ãƒ•ã‚¡ã‚¤ãƒˆã®Rã‚¹ã‚­ãƒ«ã®åŠ¹æœã¯", a: "ã®ã£ãã‚ã£ã·", choices: ["ã®ã£ãã‚ã£ã·", "ã™ãŸã‚“", "ã™ã­ã‚", "ã™ã‚ã†"]},
            {q: "ã‚¸ãƒ£ãƒ³ãƒŠã®Qã‚¹ã‚­ãƒ«ã®åŠ¹æœã¯", a: "ã®ã£ãã‚ã£ã·", choices: ["ã®ã£ãã‚ã£ã·", "ã™ãŸã‚“", "ã™ã­ã‚", "ã•ã„ã‚Œã‚“ã™"]},
            {q: "ã‚½ãƒ©ã‚«ã®Eã‚¹ã‚­ãƒ«ã®åŠ¹æœã¯", a: "ã•ã„ã‚Œã‚“ã™", choices: ["ã•ã„ã‚Œã‚“ã™", "ã™ãŸã‚“", "ã™ã­ã‚", "ã™ã‚ã†"]},
            {q: "ãƒ–ãƒªãƒƒãƒ„ã®Qã‚¹ã‚­ãƒ«ã®åŠ¹æœã¯", a: "ã²ã£ã±ã‚‹", choices: ["ã²ã£ã±ã‚‹", "ã®ã£ãã‚ã£ã·", "ã™ãŸã‚“", "ã™ã­ã‚"]},
            {q: "ã‚¹ãƒ¬ãƒƒã‚·ãƒ¥ã®Qã‚¹ã‚­ãƒ«ã®åŠ¹æœã¯", a: "ã²ã£ã±ã‚‹", choices: ["ã²ã£ã±ã‚‹", "ã™ãŸã‚“", "ã™ã­ã‚", "ã™ã‚ã†"]},
            {q: "ãƒŠã‚¦ãƒ†ã‚£ãƒ©ã‚¹ã®Qã‚¹ã‚­ãƒ«ã®åŠ¹æœã¯", a: "ã²ã£ã±ã‚‹", choices: ["ã²ã£ã±ã‚‹", "ã®ã£ãã‚ã£ã·", "ã™ãŸã‚“", "ã™ã­ã‚"]},
            {q: "ã‚·ãƒ³ãƒ‰ãƒ©ã®Eã‚¹ã‚­ãƒ«ã®åŠ¹æœã¯", a: "ã®ã£ãã°ã£ã", choices: ["ã®ã£ãã°ã£ã", "ã®ã£ãã‚ã£ã·", "ã™ãŸã‚“", "ã™ã­ã‚"]},
            {q: "ãƒ‰ãƒ¬ã‚¤ãƒ´ãƒ³ã®Eã‚¹ã‚­ãƒ«ã®åŠ¹æœã¯", a: "ã®ã£ãã°ã£ã", choices: ["ã®ã£ãã°ã£ã", "ã®ã£ãã‚ã£ã·", "ã™ãŸã‚“", "ã™ã‚ã†"]},
            {q: "ãƒ´ã‚§ã‚¤ãƒ³ã®Eã‚¹ã‚­ãƒ«ã®åŠ¹æœã¯", a: "ã®ã£ãã°ã£ã", choices: ["ã®ã£ãã°ã£ã", "ã™ãŸã‚“", "ã™ã­ã‚", "ã™ã‚ã†"]},
            {q: "ã‚¢ã‚¸ãƒ¼ãƒ«ã®Rã‚¹ã‚­ãƒ«ã®åŠ¹æœã¯", a: "ã®ã£ãã°ã£ã", choices: ["ã®ã£ãã°ã£ã", "ã®ã£ãã‚ã£ã·", "ã™ãŸã‚“", "ã™ã­ã‚"]},
            {q: "ãƒªãƒ¼ã‚·ãƒ³ã®Rã‚¹ã‚­ãƒ«ã®åŠ¹æœã¯", a: "ã®ã£ãã°ã£ã", choices: ["ã®ã£ãã°ã£ã", "ã®ã£ãã‚ã£ã·", "ã™ãŸã‚“", "ã™ã‚ãƒ¼"]},
            {q: "ã‚¸ãƒ³ã‚¯ã‚¹ã®Eã‚¹ã‚­ãƒ«ã®åŠ¹æœã¯", a: "ã™ã­ã‚", choices: ["ã™ã­ã‚", "ã™ãŸã‚“", "ã™ã‚ã†", "ã•ã„ã‚Œã‚“ã™"]},
            {q: "ã‚±ã‚¤ãƒˆãƒªãƒ³ã®Wã‚¹ã‚­ãƒ«ã®åŠ¹æœã¯", a: "ã™ã­ã‚", choices: ["ã™ã­ã‚", "ã™ãŸã‚“", "ã™ã‚ã†", "ã®ã£ãã‚ã£ã·"]},
            {q: "ãƒŠãƒŸã®Qã‚¹ã‚­ãƒ«ã®åŠ¹æœã¯", a: "ã®ã£ãã‚ã£ã·", choices: ["ã®ã£ãã‚ã£ã·", "ã™ãŸã‚“", "ã™ã­ã‚", "ã™ã‚ã†"]},
            {q: "ãƒ¤ã‚¹ã‚ªã®Rã‚¹ã‚­ãƒ«ã®å¿…è¦æ¡ä»¶ã¯", a: "ã®ã£ãã‚ã£ã·", choices: ["ã®ã£ãã‚ã£ã·", "ã™ãŸã‚“", "ã™ã­ã‚", "ã™ã‚ã†"]},
            {q: "ã‚¢ãƒªã‚¹ã‚¿ãƒ¼ã®Qã‚¹ã‚­ãƒ«ã®åŠ¹æœã¯", a: "ã®ã£ãã‚ã£ã·", choices: ["ã®ã£ãã‚ã£ã·", "ã™ãŸã‚“", "ã™ã­ã‚", "ã™ã‚ã†"]},
            {q: "ã‚«ã‚·ã‚ªãƒšã‚¢ã®Wã‚¹ã‚­ãƒ«ã®åŠ¹æœã¯", a: "ãã‚‰ã†ã‚“ã©", choices: ["ãã‚‰ã†ã‚“ã©", "ã™ãŸã‚“", "ã™ã­ã‚", "ã™ã‚ã†"]},
            {q: "ãƒãƒƒãƒ”ãƒ¼ã®Wã‚¹ã‚­ãƒ«ã®åŠ¹æœã¯", a: "ã ã£ã—ã‚…ã¶ã‚ã£ã", choices: ["ã ã£ã—ã‚…ã¶ã‚ã£ã", "ã®ã£ãã‚ã£ã·", "ã™ãŸã‚“", "ã™ã­ã‚"]},
            {q: "ãƒ´ã‚§ãƒƒã‚¯ã‚¹ã®ãƒ‘ãƒƒã‚·ãƒ–ã®åŠ¹æœã¯", a: "ã ã£ã—ã‚…ã‚’å¦¨å®³", choices: ["ã ã£ã—ã‚…ã‚’å¦¨å®³", "ã™ãŸã‚“", "ã™ã­ã‚", "ã™ã‚ã†"]},
            {q: "ã‚«ãƒ«ãƒã®Wã‚¹ã‚­ãƒ«ã®åŠ¹æœã¯", a: "ã™ã­ã‚", choices: ["ã™ã­ã‚", "ã™ãŸã‚“", "ã™ã‚ã†", "ã•ã„ã‚Œã‚“ã™"]},
            {q: "ãƒ«ã‚¯ã‚¹ã®Qã‚¹ã‚­ãƒ«ã®åŠ¹æœã¯", a: "ã™ã­ã‚", choices: ["ã™ã­ã‚", "ã™ãŸã‚“", "ã®ã£ãã‚ã£ã·", "ã™ã‚ã†"]},
            {q: "ãƒ¢ãƒ«ãƒ‡ã‚«ã‚¤ã‚¶ãƒ¼ã®Eã‚¹ã‚­ãƒ«ã®åŠ¹æœã¯", a: "ã²ã£ã±ã‚‹", choices: ["ã²ã£ã±ã‚‹", "ã®ã£ãã‚ã£ã·", "ã™ãŸã‚“", "ã™ã­ã‚"]},
            {q: "ã‚¹ã‚¦ã‚§ã‚¤ãƒ³ã®ãƒ‘ãƒƒã‚·ãƒ–ã®åŠ¹æœã¯", a: "ã²ã£ã±ã‚‹", choices: ["ã²ã£ã±ã‚‹", "ã®ã£ãã‚ã£ã·", "ã™ãŸã‚“", "ã™ã­ã‚"]},
            {q: "ã‚¢ãƒ¼ã‚´ãƒƒãƒˆã®Rã‚¹ã‚­ãƒ«ã®åŠ¹æœã¯", a: "ã²ã£ã±ã‚‹", choices: ["ã²ã£ã±ã‚‹", "ã®ã£ãã°ã£ã", "ã™ãŸã‚“", "ã™ã­ã‚"]},
            {q: "ãƒ™ãƒ«ãƒ´ã‚§ã‚¹ã®Qã‚¹ã‚­ãƒ«ã®åŠ¹æœã¯", a: "ã®ã£ãã‚ã£ã·", choices: ["ã®ã£ãã‚ã£ã·", "ã™ãŸã‚“", "ã™ã­ã‚", "ã™ã‚ã†"]},
            {q: "ã‚°ãƒ©ã‚¬ã‚¹ã®Rã‚¹ã‚­ãƒ«ã®åŠ¹æœã¯", a: "ã®ã£ãã°ã£ã", choices: ["ã®ã£ãã°ã£ã", "ã®ã£ãã‚ã£ã·", "ã™ãŸã‚“", "ã™ã­ã‚"]},
            {q: "ã‚¸ã‚§ã‚¤ã‚¹ã®Eã‚¹ã‚­ãƒ«ã®åŠ¹æœã¯", a: "ã®ã£ãã°ã£ã", choices: ["ã®ã£ãã°ã£ã", "ã®ã£ãã‚ã£ã·", "ã™ãŸã‚“", "ã™ã‚ã†"]},
            {q: "ã‚¿ãƒ­ãƒ³ã®Eã‚¹ã‚­ãƒ«ã®åŠ¹æœã¯", a: "ã‹ã¹ã“ãˆ", choices: ["ã‹ã¹ã“ãˆ", "ã ã£ã—ã‚…", "ã¦ã‚Œã½ãƒ¼ã¨", "ã˜ã‚ƒã‚“ã·"]},
            {q: "ã‚±ã‚¤ãƒ³ã®Eã‚¹ã‚­ãƒ«ã®åŠ¹æœã¯", a: "ã‹ã¹ã¨ãŠã‚Š", choices: ["ã‹ã¹ã¨ãŠã‚Š", "ã‹ã¹ã“ãˆ", "ã ã£ã—ã‚…", "ã¦ã‚Œã½ãƒ¼ã¨"]},
            {q: "ãƒãƒ¼ãƒ‰ã®Eã‚¹ã‚­ãƒ«ã®åŠ¹æœã¯", a: "ã‹ã¹ã½ãƒ¼ãŸã‚‹", choices: ["ã‹ã¹ã½ãƒ¼ãŸã‚‹", "ã‹ã¹ã“ãˆ", "ã¦ã‚Œã½ãƒ¼ã¨", "ã ã£ã—ã‚…"]},
            {q: "ãƒªã‚µãƒ³ãƒ‰ãƒ©ã®Wã‚¹ã‚­ãƒ«ã®åŠ¹æœã¯", a: "ã™ã­ã‚", choices: ["ã™ã­ã‚", "ã™ãŸã‚“", "ã™ã‚ã†", "ã•ã„ã‚Œã‚“ã™"]},
            {q: "ã‚¢ãƒ‹ãƒ“ã‚¢ã®Qã‚¹ã‚­ãƒ«ã®åŠ¹æœã¯", a: "ã™ãŸã‚“", choices: ["ã™ãŸã‚“", "ã™ã­ã‚", "ã™ã‚ã†", "ã®ã£ãã‚ã£ã·"]},
            {q: "ãƒ–ãƒ©ãƒ³ãƒ‰ã®Qã‚¹ã‚­ãƒ«ã®åŠ¹æœã¯", a: "ã™ãŸã‚“", choices: ["ã™ãŸã‚“", "ã™ã­ã‚", "ã™ã‚ã†", "ã•ã„ã‚Œã‚“ã™"]},
            {q: "ã‚½ãƒŠã®Rã‚¹ã‚­ãƒ«ã®åŠ¹æœã¯", a: "ã™ãŸã‚“", choices: ["ã™ãŸã‚“", "ã™ã­ã‚", "ã•ã„ã‚Œã‚“ã™", "ã™ã‚ã†"]},
            {q: "ã‚«ãƒ¼ã‚µã‚¹ã®Wã‚¹ã‚­ãƒ«ã®åŠ¹æœã¯", a: "ã™ã‚ã†", choices: ["ã™ã‚ã†", "ã™ãŸã‚“", "ã™ã­ã‚", "ã•ã„ã‚Œã‚“ã™"]},
            {q: "ãƒãƒ§ã‚¬ã‚¹ã®Qã‚¹ã‚­ãƒ«ã®åŠ¹æœã¯", a: "ã®ã£ãã‚ã£ã·", choices: ["ã®ã£ãã‚ã£ã·", "ã™ãŸã‚“", "ã™ã­ã‚", "ã™ã‚ã†"]},
            {q: "ãƒ©ãƒ³ãƒ–ãƒ«ã®Eã‚¹ã‚­ãƒ«ã®åŠ¹æœã¯", a: "ã™ã‚ã†", choices: ["ã™ã‚ã†", "ã™ãŸã‚“", "ã™ã­ã‚", "ã•ã„ã‚Œã‚“ã™"]}
        ],
        lore: [
            {q: "ã‚¢ãƒ¼ã‚±ã‚¤ãƒ³ã§ã‚¸ãƒ³ã‚¯ã‚¹ã®æœ¬åã¯", a: "ã±ã†ã ãƒ¼", choices: ["ã±ã†ã ãƒ¼", "ã°ã„ãŠã‚Œã£ã¨", "ãã‚‰ãã£ã©", "ãˆã“ãƒ¼"]},
            {q: "ã‚¢ãƒ¼ã‚±ã‚¤ãƒ³ã§ãƒ´ã‚¡ã‚¤ã®æœ¬åã¯", a: "ã°ã„ãŠã‚Œã£ã¨", choices: ["ã°ã„ãŠã‚Œã£ã¨", "ã±ã†ã ãƒ¼", "ãã‚‰ãã£ã©", "ã˜ã‚“ãã™"]},
            {q: "ã‚¢ãƒ¼ã‚±ã‚¤ãƒ³ã§ã‚¸ãƒ³ã‚¯ã‚¹ã¨ãƒ´ã‚¡ã‚¤ã®é–¢ä¿‚ã¯", a: "ã—ã¾ã„", choices: ["ã—ã¾ã„", "ã¨ã‚‚ã ã¡", "ã¦ã", "ã¿ã¡ã®ã²ã¨"]},
            {q: "ã‚¢ãƒ¼ã‚±ã‚¤ãƒ³ã®èˆå°ã¨ãªã‚‹éƒ½å¸‚ã¯", a: "ã´ã‚‹ã¨ãŠãƒ¼ã†ã‚›ããƒ¼", choices: ["ã´ã‚‹ã¨ãŠãƒ¼ã†ã‚›ããƒ¼", "ã§ã¾ãƒ¼ã—ã‚", "ã®ãã•ã™", "ã‚ã„ãŠã«ã‚"]},
            {q: "ãƒ¤ã‚¹ã‚ªã®æ•…éƒ·ã®åœ°åŸŸã¯", a: "ã‚ã„ãŠã«ã‚", choices: ["ã‚ã„ãŠã«ã‚", "ã§ã¾ãƒ¼ã—ã‚", "ã®ãã•ã™", "ãµã‚Œã‚‹ã‚ˆã‚‹ã©"]},
            {q: "ã‚¬ãƒ¬ãƒ³ã¨ãƒ«ã‚¯ã‚¹ã®å‡ºèº«åœ°ã¯", a: "ã§ã¾ãƒ¼ã—ã‚", choices: ["ã§ã¾ãƒ¼ã—ã‚", "ã®ãã•ã™", "ã‚ã„ãŠã«ã‚", "ã´ã‚‹ã¨ãŠãƒ¼ã†ã‚›ããƒ¼"]},
            {q: "ãƒ€ãƒªã‚¦ã‚¹ã¨ãƒ‰ãƒ¬ã‚¤ãƒ´ãƒ³ã®é–¢ä¿‚ã¯", a: "ãã‚‡ã†ã ã„", choices: ["ãã‚‡ã†ã ã„", "ã¨ã‚‚ã ã¡", "ã¦ã", "ã¿ã¡ã®ã²ã¨"]},
            {q: "ã‚¢ãƒ¼ãƒªã®ç¨®æ—ã¯", a: "ãã¤ã­", choices: ["ãã¤ã­", "ãŠãŠã‹ã¿", "ã‚Šã‚…ã†", "ã«ã‚“ã’ã‚“"]},
            {q: "ãƒŠã‚µã‚¹ã¨ãƒ¬ãƒã‚¯ãƒˆãƒ³ã®ç¨®æ—ã¯", a: "ã—ã‚…ã†ã‚Šã¾", choices: ["ã—ã‚…ã†ã‚Šã¾", "ã§ã¾ãƒ¼ã—ã‚", "ã‚ã„ãŠã«ã‚", "ã‚ˆãƒ¼ã©ã‚‹"]},
            {q: "ãƒ†ã‚£ãƒ¼ãƒ¢ã®ç¨®æ—ã¯", a: "ã‚ˆãƒ¼ã©ã‚‹", choices: ["ã‚ˆãƒ¼ã©ã‚‹", "ã«ã‚“ã’ã‚“", "ãˆã‚‹ãµ", "ã©ã‚ãƒ¼ãµ"]},
            {q: "ã‚¸ãƒ³ã‚¯ã‚¹ã¨ãƒ´ã‚¡ã‚¤ãŒè‚²ã£ãŸå ´æ‰€ã¯", a: "ããƒ¼ã‚“", choices: ["ããƒ¼ã‚“", "ã´ã‚‹ã¨ãŠãƒ¼ã†ã‚›ããƒ¼", "ã§ã¾ãƒ¼ã—ã‚", "ã®ãã•ã™"]},
            {q: "ã‚¢ãƒ¼ã‚±ã‚¤ãƒ³ã§ã‚¸ãƒ³ã‚¯ã‚¹ã‚’è‚²ã¦ãŸäººç‰©ã¯", a: "ã—ã‚‹ã“", choices: ["ã—ã‚‹ã“", "ã†ã‚›ãã‚“ã ãƒ¼", "ã˜ã‡ã„ã™", "ã†ã‚›ãƒããŸãƒ¼"]},
            {q: "ã‚¢ãƒ¼ã‚±ã‚¤ãƒ³ã§ã‚¨ã‚³ãƒ¼ã®æ­¦å™¨ã¯", a: "ã˜ã‹ã‚“ãã†ã¡", choices: ["ã˜ã‹ã‚“ãã†ã¡", "ã‘ã‚“", "ã˜ã‚…ã†", "ãŠã®"]},
            {q: "ã‚¢ãƒ¼ã‚±ã‚¤ãƒ³ã§ã‚¸ã‚§ã‚¤ã‚¹ãŒä½œã£ãŸé“å…·ã¯", a: "ã¸ãã™ã¦ã£ãã’ãƒ¼ã¨", choices: ["ã¸ãã™ã¦ã£ãã’ãƒ¼ã¨", "ã˜ã‹ã‚“ãã†ã¡", "ã‚ã¼ã£ã¨", "ã²ã“ã†ã"]},
            {q: "ã‚¼ãƒ‰ã¨ã‚·ã‚§ãƒ³ã®é–¢ä¿‚ã¯", a: "ãã‚‡ã†ã ã„ã§ã—", choices: ["ãã‚‡ã†ã ã„ã§ã—", "ã¨ã‚‚ã ã¡", "ã¦ã", "ã¿ã¡ã®ã²ã¨"]},
            {q: "ãƒ¤ã‚¹ã‚ªã¨ãƒ¨ãƒã®é–¢ä¿‚ã¯", a: "ãã‚‡ã†ã ã„", choices: ["ãã‚‡ã†ã ã„", "ã¨ã‚‚ã ã¡", "ã¦ã", "ã¿ã¡ã®ã²ã¨"]},
            {q: "ã‚¬ãƒ¬ãƒ³ã¨ã‚«ã‚¿ãƒªãƒŠã®é–¢ä¿‚ã¯", a: "ã¦ãã©ã†ã—ã®ã“ã„", choices: ["ã¦ãã©ã†ã—ã®ã“ã„", "ãã‚‡ã†ã ã„", "ã¨ã‚‚ã ã¡", "ã¦ã"]},
            {q: "ãƒ©ã‚«ãƒ³ã¨ã‚¶ãƒ¤ã®é–¢ä¿‚ã¯", a: "ã“ã„ã³ã¨", choices: ["ã“ã„ã³ã¨", "ãã‚‡ã†ã ã„", "ã¨ã‚‚ã ã¡", "ã¦ã"]},
            {q: "ã‚¢ãƒƒã‚·ãƒ¥ã¨ãƒˆãƒªãƒ³ãƒ€ãƒ¡ã‚¢ã®é–¢ä¿‚ã¯", a: "ãµã†ãµ", choices: ["ãµã†ãµ", "ãã‚‡ã†ã ã„", "ã¨ã‚‚ã ã¡", "ã¦ã"]},
            {q: "ãƒ«ã‚·ã‚¢ãƒ³ã¨ã‚»ãƒŠã®é–¢ä¿‚ã¯", a: "ãµã†ãµ", choices: ["ãµã†ãµ", "ãã‚‡ã†ã ã„", "ã¨ã‚‚ã ã¡", "ã¦ã"]}
        ],
        combo: [
            {q: "ãƒ¤ã‚¹ã‚ªã®åŸºæœ¬ã‚³ãƒ³ãƒœã¯", a: "Eâ†’Qâ†’R", choices: ["Eâ†’Qâ†’R", "Qâ†’Eâ†’R", "Râ†’Eâ†’Q", "Qâ†’Râ†’E"]},
            {q: "ã‚¼ãƒ‰ã®ãƒ¯ãƒ³ã‚³ãƒ³ãƒœã¯", a: "Wâ†’Eâ†’Qâ†’R", choices: ["Wâ†’Eâ†’Qâ†’R", "Râ†’Wâ†’Qâ†’E", "Qâ†’Wâ†’Eâ†’R", "Eâ†’Wâ†’Râ†’Q"]},
            {q: "ãƒªãƒ¼ã‚·ãƒ³ã®ã‚¤ãƒ³ã‚»ãƒƒã‚¯ã¯", a: "Qâ†’Qâ†’Râ†’F", choices: ["Qâ†’Qâ†’Râ†’F", "Râ†’Qâ†’F", "Fâ†’Râ†’Q", "Wâ†’Râ†’Q"]},
            {q: "ã‚¢ãƒ¼ãƒªã®ãƒãƒ¼ã‚¹ãƒˆã‚³ãƒ³ãƒœã¯", a: "Eâ†’Wâ†’Qâ†’R", choices: ["Eâ†’Wâ†’Qâ†’R", "Qâ†’Eâ†’Wâ†’R", "Râ†’Eâ†’Qâ†’W", "Wâ†’Eâ†’Râ†’Q"]},
            {q: "ã‚¢ãƒ‹ãƒ¼ã®ã‚¹ã‚¿ãƒ³ã‚³ãƒ³ãƒœã¯", a: "Râ†’Wâ†’Q", choices: ["Râ†’Wâ†’Q", "Qâ†’Wâ†’R", "Wâ†’Qâ†’R", "Qâ†’Râ†’W"]},
            {q: "ã‚·ãƒ³ãƒ‰ãƒ©ã®ãƒ¯ãƒ³ã‚³ãƒ³ãƒœã¯", a: "Qâ†’Eâ†’R", choices: ["Qâ†’Eâ†’R", "Eâ†’Qâ†’R", "Râ†’Qâ†’E", "Qâ†’Râ†’E"]},
            {q: "ãƒ¬ã‚ªãƒŠã®ãƒ•ãƒ«ã‚³ãƒ³ãƒœã¯", a: "Eâ†’Qâ†’R", choices: ["Eâ†’Qâ†’R", "Qâ†’Eâ†’R", "Râ†’Eâ†’Q", "Qâ†’Râ†’E"]},
            {q: "ãƒãƒ«ãƒ•ã‚¡ã‚¤ãƒˆã®ã‚¨ãƒ³ã‚²ãƒ¼ã‚¸ã¯", a: "Râ†’Eâ†’Q", choices: ["Râ†’Eâ†’Q", "Eâ†’Râ†’Q", "Qâ†’Râ†’E", "Râ†’Qâ†’E"]},
            {q: "ã‚«ã‚¿ãƒªãƒŠã®ãƒªã‚»ãƒƒãƒˆã‚³ãƒ³ãƒœã¯", a: "Eâ†’Wâ†’Qâ†’R", choices: ["Eâ†’Wâ†’Qâ†’R", "Qâ†’Wâ†’Eâ†’R", "Râ†’Eâ†’Qâ†’W", "Wâ†’Eâ†’Râ†’Q"]},
            {q: "ãƒ•ã‚£ã‚ºã®ãƒãƒ¼ã‚¹ãƒˆã‚³ãƒ³ãƒœã¯", a: "Qâ†’Wâ†’Eâ†’R", choices: ["Qâ†’Wâ†’Eâ†’R", "Râ†’Qâ†’Wâ†’E", "Eâ†’Qâ†’Wâ†’R", "Wâ†’Qâ†’Râ†’E"]},
            {q: "ã‚¢ã‚«ãƒªã®ã‚³ãƒ³ãƒœã¯", a: "Qâ†’Eâ†’Râ†’AA", choices: ["Qâ†’Eâ†’Râ†’AA", "Eâ†’Qâ†’Râ†’AA", "Râ†’Eâ†’Qâ†’AA", "Qâ†’Râ†’Eâ†’AA"]},
            {q: "ãƒ€ã‚¤ã‚¢ãƒŠã®ã‚³ãƒ³ãƒœã¯", a: "Qâ†’Râ†’Wâ†’E", choices: ["Qâ†’Râ†’Wâ†’E", "Râ†’Qâ†’Wâ†’E", "Wâ†’Qâ†’Râ†’E", "Qâ†’Wâ†’Râ†’E"]},
            {q: "ã‚¨ã‚³ãƒ¼ã®ã‚³ãƒ³ãƒœã¯", a: "Eâ†’Qâ†’AAâ†’R", choices: ["Eâ†’Qâ†’AAâ†’R", "Qâ†’Eâ†’AAâ†’R", "Râ†’Eâ†’Qâ†’AA", "Qâ†’AAâ†’Eâ†’R"]},
            {q: "ã‚«ã‚µãƒ‡ã‚£ãƒ³ã®ã‚³ãƒ³ãƒœã¯", a: "Râ†’Eâ†’Qâ†’W", choices: ["Râ†’Eâ†’Qâ†’W", "Eâ†’Râ†’Qâ†’W", "Qâ†’Râ†’Eâ†’W", "Râ†’Qâ†’Eâ†’W"]},
            {q: "ãƒ–ãƒ©ãƒƒãƒ‰ãƒŸã‚¢ã®ã‚³ãƒ³ãƒœã¯", a: "Eâ†’Qâ†’Râ†’W", choices: ["Eâ†’Qâ†’Râ†’W", "Qâ†’Eâ†’Râ†’W", "Râ†’Eâ†’Qâ†’W", "Qâ†’Râ†’Eâ†’W"]}
        ],
        cooldown: [
            {q: "ãƒ•ãƒ©ãƒƒã‚·ãƒ¥ã®ã‚¯ãƒ¼ãƒ«ãƒ€ã‚¦ãƒ³ã¯", a: "5ãµã‚“", choices: ["5ãµã‚“", "3ãµã‚“", "7ãµã‚“", "4ãµã‚“"]},
            {q: "ã‚¤ã‚°ãƒŠã‚¤ãƒˆã®ã‚¯ãƒ¼ãƒ«ãƒ€ã‚¦ãƒ³ã¯", a: "3ãµã‚“", choices: ["3ãµã‚“", "5ãµã‚“", "2ãµã‚“", "4ãµã‚“"]},
            {q: "ãƒ†ãƒ¬ãƒãƒ¼ãƒˆåºç›¤ã®ã‚¯ãƒ¼ãƒ«ãƒ€ã‚¦ãƒ³ã¯", a: "6ãµã‚“", choices: ["6ãµã‚“", "5ãµã‚“", "7ãµã‚“", "4ãµã‚“"]},
            {q: "ãƒ’ãƒ¼ãƒ«ã®ã‚¯ãƒ¼ãƒ«ãƒ€ã‚¦ãƒ³ã¯", a: "4ãµã‚“", choices: ["4ãµã‚“", "3ãµã‚“", "5ãµã‚“", "2ãµã‚“"]},
            {q: "ãƒãƒªã‚¢ã®ã‚¯ãƒ¼ãƒ«ãƒ€ã‚¦ãƒ³ã¯", a: "3ãµã‚“", choices: ["3ãµã‚“", "4ãµã‚“", "5ãµã‚“", "2ãµã‚“"]},
            {q: "ã‚¯ãƒ¬ãƒ³ã‚ºã®ã‚¯ãƒ¼ãƒ«ãƒ€ã‚¦ãƒ³ã¯", a: "3ãµã‚“30ã³ã‚‡ã†", choices: ["3ãµã‚“30ã³ã‚‡ã†", "3ãµã‚“", "4ãµã‚“", "2ãµã‚“30ã³ã‚‡ã†"]},
            {q: "ã‚´ãƒ¼ã‚¹ãƒˆã®ã‚¯ãƒ¼ãƒ«ãƒ€ã‚¦ãƒ³ã¯", a: "3ãµã‚“30ã³ã‚‡ã†", choices: ["3ãµã‚“30ã³ã‚‡ã†", "3ãµã‚“", "4ãµã‚“", "5ãµã‚“"]},
            {q: "ã‚¤ã‚°ã‚¾ãƒ¼ã‚¹ãƒˆã®ã‚¯ãƒ¼ãƒ«ãƒ€ã‚¦ãƒ³ã¯", a: "3ãµã‚“30ã³ã‚‡ã†", choices: ["3ãµã‚“30ã³ã‚‡ã†", "3ãµã‚“", "4ãµã‚“", "5ãµã‚“"]},
            {q: "ã‚¹ãƒã‚¤ãƒˆã®ã‚¯ãƒ¼ãƒ«ãƒ€ã‚¦ãƒ³ã¯", a: "90ã³ã‚‡ã†", choices: ["90ã³ã‚‡ã†", "60ã³ã‚‡ã†", "120ã³ã‚‡ã†", "75ã³ã‚‡ã†"]},
            {q: "ãƒãƒ¼ã‚¯ã®ã‚¯ãƒ¼ãƒ«ãƒ€ã‚¦ãƒ³ã¯", a: "80ã³ã‚‡ã†", choices: ["80ã³ã‚‡ã†", "60ã³ã‚‡ã†", "90ã³ã‚‡ã†", "100ã³ã‚‡ã†"]}
        ],
        proplay: [
            {q: "2023å¹´ãƒ¯ãƒ¼ãƒ«ãƒ‰ã®å„ªå‹ãƒãƒ¼ãƒ ã¯", a: "T1", choices: ["T1", "JDG", "WBG", "GEN"]},
            {q: "2022å¹´ãƒ¯ãƒ¼ãƒ«ãƒ‰ã®å„ªå‹ãƒãƒ¼ãƒ ã¯", a: "DRX", choices: ["DRX", "T1", "GEN", "JDG"]},
            {q: "2021å¹´ãƒ¯ãƒ¼ãƒ«ãƒ‰ã®å„ªå‹ãƒãƒ¼ãƒ ã¯", a: "EDG", choices: ["EDG", "DK", "T1", "GEN"]},
            {q: "2020å¹´ãƒ¯ãƒ¼ãƒ«ãƒ‰ã®å„ªå‹ãƒãƒ¼ãƒ ã¯", a: "DWG", choices: ["DWG", "SN", "G2", "TES"]},
            {q: "2019å¹´ãƒ¯ãƒ¼ãƒ«ãƒ‰ã®å„ªå‹ãƒãƒ¼ãƒ ã¯", a: "FPX", choices: ["FPX", "G2", "SKT", "IG"]},
            {q: "2018å¹´ãƒ¯ãƒ¼ãƒ«ãƒ‰ã®å„ªå‹ãƒãƒ¼ãƒ ã¯", a: "IG", choices: ["IG", "FNC", "G2", "RNG"]},
            {q: "Season1ãƒ¯ãƒ¼ãƒ«ãƒ‰ã®å„ªå‹ãƒãƒ¼ãƒ ã¯", a: "FNC", choices: ["FNC", "AAA", "TSM", "CLG"]},
            {q: "æœ€å¤šãƒ¯ãƒ¼ãƒ«ãƒ‰å„ªå‹ãƒãƒ¼ãƒ ã¯", a: "T1", choices: ["T1", "GEN", "FNC", "EDG"]},
            {q: "Fakerã®æœ¬åã¯", a: "ã„ã•ã‚“ã²ã‚‡ã", choices: ["ã„ã•ã‚“ã²ã‚‡ã", "ã±ãã˜ã†ã‚“", "ãã‚€ã˜ã‚‡ã‚“ãã‚‡ã‚“", "ã¡ã‡ã†ã˜"]},
            {q: "LCKã®å‰èº«ãƒªãƒ¼ã‚°åã¯", a: "OGN", choices: ["OGN", "LPL", "LCS", "LEC"]},
            {q: "2023å¹´MSIã®å„ªå‹ãƒãƒ¼ãƒ ã¯", a: "JDG", choices: ["JDG", "T1", "GEN", "BLG"]},
            {q: "2022å¹´MSIã®å„ªå‹ãƒãƒ¼ãƒ ã¯", a: "RNG", choices: ["RNG", "T1", "G2", "EG"]},
            {q: "Fakerã®åˆå„ªå‹ã®å¹´ã¯", a: "2013", choices: ["2013", "2012", "2014", "2011"]},
            {q: "æœ€å¹´å°‘ãƒ¯ãƒ¼ãƒ«ãƒ‰å„ªå‹é¸æ‰‹ã¯", a: "ã´ãƒ¼ãªã£ã¤", choices: ["ã´ãƒ¼ãªã£ã¤", "ãµã‡ã„ã‹ãƒ¼", "ãã‚ƒã«ãŠã‚“", "ã—ã‚‡ãƒ¼ã‚ã„ã‹ãƒ¼"]},
            {q: "T1ã®æ—§ãƒãƒ¼ãƒ åã¯", a: "SKT", choices: ["SKT", "KT", "SSG", "ROX"]}
        ]
    };

    championData.forEach(function(champ) {
        questionDB.champion.push({
            q: "ã“ã®ãƒãƒ£ãƒ³ãƒ”ã‚ªãƒ³ã¯èª°ã§ã™ã‹",
            a: champ.jp,
            championId: champ.id
        });
    });

    class StorageManager {
        constructor() {
            this.prefix = 'lol_quiz_perfect_';
        }
        get(key) {
            try {
                const data = localStorage.getItem(this.prefix + key);
                return data ? JSON.parse(data) : null;
            } catch (e) {
                return null;
            }
        }
        set(key, value) {
            try {
                localStorage.setItem(this.prefix + key, JSON.stringify(value));
                return true;
            } catch (e) {
                return false;
            }
        }
    }

    const storage = new StorageManager();

    let state = {
        roomCode: null,
        playerName: null,
        isHost: false,
        players: [],
        categories: ['champion'],
        winPoints: 10,
        mistakesAllowed: 2,
        currentRound: 1,
        currentQuestion: null,
        scores: {},
        mistakes: {},
        timer: null,
        timeLeft: 30,
        questions: [],
        usedQuestions: [],
        playerAnswers: {},
        answeredPlayers: [],
        currentAnswer: '',
        currentChoices: [],
        buzzed: false,
        answeringPlayer: null,
        hasAnswered: false
    };

    let pollInterval = null;

    function generateRoomCode() {
        const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
        let code = '';
        for (let i = 0; i < 6; i++) {
            code += chars.charAt(Math.floor(Math.random() * chars.length));
        }
        return code;
    }

    function showScreen(screenId) {
        document.querySelectorAll('.screen').forEach(function(s) {
            s.classList.remove('active');
        });
        document.getElementById(screenId).classList.add('active');
    }

    function updateConnectionStatus(connected) {
        const dot = document.getElementById('statusDot');
        const text = document.getElementById('statusText');
        if (connected) {
            dot.classList.remove('disconnected');
            text.textContent = 'ã‚ªãƒ³ãƒ©ã‚¤ãƒ³';
        } else {
            dot.classList.add('disconnected');
            text.textContent = 'åˆ‡æ–­';
        }
    }

    function createRoom() {
        const playerName = document.getElementById('playerName').value.trim();
        if (!playerName) {
            alert('ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼åã‚’å…¥åŠ›ã—ã¦ãã ã•ã„');
            return;
        }
        if (audioCtx.state === 'suspended') audioCtx.resume();
        const roomCode = generateRoomCode();
        state.roomCode = roomCode;
        state.playerName = playerName;
        state.isHost = true;
        state.players = [{name: playerName, isHost: true}];
        state.scores[playerName] = 0;
        state.mistakes[playerName] = 0;
        storage.set('room_' + roomCode, {
            host: playerName,
            players: state.players,
            categories: ['champion'],
            winPoints: 10,
            mistakesAllowed: 2,
            gameStarted: false,
            currentRound: 0,
            currentQuestion: null,
            scores: state.scores,
            mistakes: state.mistakes,
            usedQuestions: [],
            playerAnswers: {},
            answeredPlayers: [],
            buzzed: false,
            answeringPlayer: null
        });
        showLobby();
        startPolling();
    }

    function showJoinRoom() {
        showScreen('joinScreen');
    }

    function joinRoom() {
        const playerName = document.getElementById('playerName').value.trim();
        const roomCode = document.getElementById('roomCodeInput').value.trim().toUpperCase();
        if (!playerName) {
            alert('ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼åã‚’å…¥åŠ›ã—ã¦ãã ã•ã„');
            return;
        }
        if (!roomCode || roomCode.length !== 6) {
            alert('6æ¡ã®ãƒ«ãƒ¼ãƒ ã‚³ãƒ¼ãƒ‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„');
            return;
        }
        if (audioCtx.state === 'suspended') audioCtx.resume();
        const roomData = storage.get('room_' + roomCode);
        if (!roomData) {
            alert('ãƒ«ãƒ¼ãƒ ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“');
            return;
        }
        const nameExists = roomData.players.some(function(p) {
            return p.name === playerName;
        });
        if (nameExists) {
            alert('ã“ã®åå‰ã¯æ—¢ã«ä½¿ç”¨ã•ã‚Œã¦ã„ã¾ã™');
            return;
        }
        state.roomCode = roomCode;
        state.playerName = playerName;
        state.isHost = false;
        roomData.players.push({name: playerName, isHost: false});
        roomData.scores[playerName] = 0;
        roomData.mistakes[playerName] = 0;
        storage.set('room_' + roomCode, roomData);
        showLobby();
        startPolling();
    }

    function showHome() {
        showScreen('homeScreen');
    }

    function showLobby() {
        showScreen('lobbyScreen');
        document.getElementById('roomCode').textContent = state.roomCode;
        if (state.isHost) {
            document.getElementById('hostSettings').style.display = 'block';
            document.getElementById('hostSettings2').style.display = 'grid';
            document.getElementById('startGameBtn').style.display = 'block';
        } else {
            document.getElementById('hostSettings').style.display = 'none';
            document.getElementById('hostSettings2').style.display = 'none';
            document.getElementById('startGameBtn').style.display = 'none';
        }
        updateConnectionStatus(true);
    }

    function startPolling() {
        if (pollInterval) clearInterval(pollInterval);
        pollInterval = setInterval(function() {
            const roomData = storage.get('room_' + state.roomCode);
            if (!roomData) {
                updateConnectionStatus(false);
                return;
            }
            updateConnectionStatus(true);
            state.players = roomData.players;
            updatePlayersList();
            const quizActive = document.getElementById('quizScreen').classList.contains('active');
            if (roomData.gameStarted && !quizActive) {
                state.categories = roomData.categories;
                state.winPoints = roomData.winPoints;
                state.mistakesAllowed = roomData.mistakesAllowed;
                state.usedQuestions = roomData.usedQuestions || [];
                loadQuestions();
                showScreen('quizScreen');
                if (state.isHost) {
                    nextQuestion();
                }
            }
            if (quizActive) {
                syncGameState();
            }
        }, 1000);
    }

    function updatePlayersList() {
        const list = document.getElementById('playersList');
        list.innerHTML = '';
        state.players.forEach(function(player) {
            const div = document.createElement('div');
            div.style.cssText = 'display: flex; align-items: center; padding: 0.6rem; margin-bottom: 0.4rem; background: rgba(255, 255, 255, 0.05); border-radius: 8px; border-left: 3px solid ' + (player.isHost ? 'var(--gold)' : 'var(--blue)');
            div.innerHTML = '<div style="width: 35px; height: 35px; background: var(--gold); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 700; font-size: 1rem; color: var(--dark-blue); margin-right: 0.8rem;">' + player.name.charAt(0).toUpperCase() + '</div>' +
                           '<div style="flex: 1; font-weight: 700; font-size: 0.9rem;">' + player.name + '</div>' +
                           (player.isHost ? '<span style="background: var(--gold); color: var(--dark-blue); padding: 0.2rem 0.6rem; border-radius: 12px; font-size: 0.75rem; font-weight: 700;">HOST</span>' : '');
            list.appendChild(div);
        });
    }

    function copyRoomCode() {
        navigator.clipboard.writeText(state.roomCode);
        const btn = document.getElementById('copyCodeBtn');
        const orig = btn.textContent;
        btn.textContent = 'âœ“ ã‚³ãƒ”ãƒ¼å®Œäº†';
        setTimeout(function() {
            btn.textContent = orig;
        }, 2000);
    }

    document.getElementById('categoryGrid').addEventListener('click', function(e) {
        if (!state.isHost) return;
        const option = e.target.closest('.category-option');
        if (!option) return;
        option.classList.toggle('selected');
    });

    function startGameFromLobby() {
        if (!state.isHost) return;
        const selectedCategories = [];
        document.querySelectorAll('.category-option.selected').forEach(function(opt) {
            selectedCategories.push(opt.getAttribute('data-category'));
        });
        if (selectedCategories.length === 0) {
            alert('å°‘ãªãã¨ã‚‚1ã¤ã®å‡ºé¡Œç¯„å›²ã‚’é¸æŠã—ã¦ãã ã•ã„');
            return;
        }
        const winPoints = parseInt(document.getElementById('winPoints').value);
        const mistakesAllowed = parseInt(document.getElementById('mistakesAllowed').value);
        state.winPoints = winPoints;
        state.mistakesAllowed = mistakesAllowed;
        state.categories = selectedCategories;
        const roomData = storage.get('room_' + state.roomCode);
        roomData.gameStarted = true;
        roomData.categories = selectedCategories;
        roomData.winPoints = winPoints;
        roomData.mistakesAllowed = mistakesAllowed;
        roomData.currentRound = 1;
        roomData.usedQuestions = [];
        state.players.forEach(function(p) {
            state.scores[p.name] = 0;
            state.mistakes[p.name] = 0;
        });
        roomData.scores = state.scores;
        roomData.mistakes = state.mistakes;
        storage.set('room_' + state.roomCode, roomData);
    }

    function loadQuestions() {
        let allQuestions = [];
        state.categories.forEach(function(cat) {
            if (questionDB[cat]) {
                allQuestions = allQuestions.concat(questionDB[cat]);
            }
        });
        state.questions = allQuestions;
    }

    function getRandomUnusedQuestion() {
        const available = state.questions.filter(function(q) {
            const key = JSON.stringify({q: q.q, a: q.a});
            return state.usedQuestions.indexOf(key) === -1;
        });
        if (available.length === 0) {
            state.usedQuestions = [];
            return state.questions[Math.floor(Math.random() * state.questions.length)];
        }
        return available[Math.floor(Math.random() * available.length)];
    }

    function nextQuestion() {
        if (!state.isHost) return;
        
        const hasWinner = state.players.some(function(p) {
            return (state.scores[p.name] || 0) >= state.winPoints;
        });
        
        if (hasWinner) {
            const roomData = storage.get('room_' + state.roomCode);
            roomData.showResults = true;
            storage.set('room_' + state.roomCode, roomData);
            showResults();
            return;
        }

        const question = getRandomUnusedQuestion();
        const key = JSON.stringify({q: question.q, a: question.a});
        state.currentQuestion = question;
        state.usedQuestions.push(key);
        state.playerAnswers = {};
        state.answeredPlayers = [];
        state.buzzed = false;
        state.answeringPlayer = null;
        
        const roomData = storage.get('room_' + state.roomCode);
        roomData.currentQuestion = question;
        roomData.currentRound = state.currentRound;
        roomData.usedQuestions = state.usedQuestions;
        roomData.playerAnswers = {};
        roomData.answeredPlayers = [];
        roomData.buzzed = false;
        roomData.answeringPlayer = null;
        storage.set('room_' + state.roomCode, roomData);
        
        displayQuestion();
        startTimer();
    }

    function displayQuestion() {
        if (!state.currentQuestion) return;
        
        document.getElementById('questionText').textContent = state.currentQuestion.q;
        document.getElementById('currentRound').textContent = state.currentRound;
        
        const imgEl = document.getElementById('questionImage');
        if (state.currentQuestion.championId) {
            imgEl.src = 'https://ddragon.leagueoflegends.com/cdn/img/champion/splash/' + state.currentQuestion.championId + '_0.jpg';
            imgEl.style.display = 'block';
        } else {
            imgEl.style.display = 'none';
        }
        
        state.currentAnswer = '';
        state.hasAnswered = false;
        state.buzzed = false;
        document.getElementById('buzzerSection').style.display = 'block';
        document.getElementById('answerSection').style.display = 'none';
        document.getElementById('buzzerBtn').disabled = false;
        document.getElementById('answerProgress').innerHTML = '';
        updateScoreboard();
    }

    function buzzerPressed() {
        if (state.buzzed || state.hasAnswered) return;
        playClick();
        state.buzzed = true;
        const roomData = storage.get('room_' + state.roomCode);
        if (roomData.buzzed) {
            alert('ä»–ã®ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ãŒå…ˆã«å›ç­”ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¾ã—ãŸ');
            state.buzzed = false;
            return;
        }
        roomData.buzzed = true;
        roomData.answeringPlayer = state.playerName;
        storage.set('room_' + state.roomCode, roomData);
        document.getElementById('buzzerBtn').disabled = true;
    }

    function syncGameState() {
        const roomData = storage.get('room_' + state.roomCode);
        if (!roomData) return;
        
        state.scores = roomData.scores || {};
        state.mistakes = roomData.mistakes || {};
        state.currentRound = roomData.currentRound || 1;
        state.usedQuestions = roomData.usedQuestions || [];
        
        const currentQuestionKey = state.currentQuestion ? JSON.stringify({q: state.currentQuestion.q, a: state.currentQuestion.a}) : null;
        const roomQuestionKey = roomData.currentQuestion ? JSON.stringify({q: roomData.currentQuestion.q, a: roomData.currentQuestion.a}) : null;
        
        if (roomQuestionKey && roomQuestionKey !== currentQuestionKey) {
            state.currentQuestion = roomData.currentQuestion;
            state.playerAnswers = {};
            state.answeredPlayers = [];
            state.currentAnswer = '';
            state.buzzed = false;
            state.answeringPlayer = null;
            state.hasAnswered = false;
            displayQuestion();
        }
        
        if (roomData.buzzed && roomData.answeringPlayer) {
            state.buzzed = true;
            state.answeringPlayer = roomData.answeringPlayer;
            if (state.answeringPlayer === state.playerName && !state.hasAnswered && document.getElementById('answerSection').style.display === 'none') {
                document.getElementById('buzzerSection').style.display = 'none';
                document.getElementById('answerSection').style.display = 'flex';
                document.getElementById('answerDisplay').textContent = '';
                state.currentAnswer = '';
                generateChoices();
            } else if (state.answeringPlayer !== state.playerName) {
                document.getElementById('buzzerBtn').disabled = true;
            }
        }
        
        if (roomData.answeredPlayers) {
            updateAnswerProgress(roomData.answeredPlayers);
        }
        
        updateScoreboard();
        
        if (roomData.showResults) {
            clearInterval(pollInterval);
            showResults();
            return;
        }
        
        const activePlayers = roomData.players.filter(function(p) {
            return (roomData.mistakes[p.name] || 0) <= state.mistakesAllowed;
        });
        
        const allAnswered = activePlayers.every(function(p) {
            return roomData.answeredPlayers.some(function(ap) {
                return ap.name === p.name;
            });
        });
        
        if (allAnswered && state.isHost && roomData.answeredPlayers.length > 0) {
            clearInterval(state.timer);
            calculateScores();
            setTimeout(function() {
                state.currentRound++;
                nextQuestion();
            }, 3000);
        }
    }

    function generateChoices() {
        const question = state.currentQuestion;
        
        if (question.choices) {
            state.currentChoices = question.choices.slice();
            renderChoices();
        } else {
            generateTextChoices(0);
        }
    }

    function renderChoices() {
        const grid = document.getElementById('choiceGrid');
        grid.innerHTML = '';
        state.currentChoices.forEach(function(choice) {
            const btn = document.createElement('button');
            btn.className = 'choice-btn';
            btn.textContent = choice;
            btn.onclick = function() { 
                if (!state.hasAnswered) {
                    selectChoice(choice);
                }
            };
            grid.appendChild(btn);
        });
    }

    function generateTextChoices(position) {
        const answer = state.currentQuestion.a;
        if (position >= answer.length) return;
        
        const correctChar = answer.charAt(position);
        const allChars = 'ã‚ã„ã†ãˆãŠã‹ããã‘ã“ã•ã—ã™ã›ããŸã¡ã¤ã¦ã¨ãªã«ã¬ã­ã®ã¯ã²ãµã¸ã»ã¾ã¿ã‚€ã‚ã‚‚ã‚„ã‚†ã‚ˆã‚‰ã‚Šã‚‹ã‚Œã‚ã‚ã‚’ã‚“ãŒããã’ã”ã–ã˜ãšãœãã ã¢ã¥ã§ã©ã°ã³ã¶ã¹ã¼ã±ã´ã·ãºã½ã‚ƒã‚…ã‚‡ã£ãƒ¼';
        const choices = [correctChar];
        
        while (choices.length < 4) {
            const randomChar = allChars.charAt(Math.floor(Math.random() * allChars.length));
            if (choices.indexOf(randomChar) === -1 && randomChar !== correctChar) {
                choices.push(randomChar);
            }
        }
        
        for (let i = choices.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            const temp = choices[i];
            choices[i] = choices[j];
            choices[j] = temp;
        }
        
        state.currentChoices = choices;
        renderChoices();
    }

    function selectChoice(char) {
        if (state.hasAnswered) return;
        playClick();
        state.currentAnswer += char;
        document.getElementById('answerDisplay').textContent = state.currentAnswer;
        
        if (state.currentQuestion.choices) {
            submitAnswer();
        } else if (state.currentAnswer.length < state.currentQuestion.a.length) {
            generateTextChoices(state.currentAnswer.length);
        } else {
            submitAnswer();
        }
    }

    function submitAnswer() {
        if (state.hasAnswered) return;
        state.hasAnswered = true;
        
        const answer = state.currentAnswer;
        const correct = answer === state.currentQuestion.a;
        const roomData = storage.get('room_' + state.roomCode);
        const timestamp = Date.now();
        
        if (!roomData.playerAnswers) {
            roomData.playerAnswers = {};
        }
        roomData.playerAnswers[state.playerName] = {
            answer: answer,
            correct: correct,
            timestamp: timestamp
        };
        
        if (!roomData.answeredPlayers) {
            roomData.answeredPlayers = [];
        }
        roomData.answeredPlayers.push({
            name: state.playerName,
            timestamp: timestamp,
            correct: correct
        });
        
        if (!correct) {
            roomData.mistakes[state.playerName] = (roomData.mistakes[state.playerName] || 0) + 1;
        }
        
        storage.set('room_' + state.roomCode, roomData);
        
        document.querySelectorAll('.choice-btn').forEach(function(btn) {
            btn.disabled = true;
        });
        document.getElementById('answerSection').style.display = 'none';
        
        if (correct) {
            playCorrect();
        } else {
            playWrong();
        }
    }

    function updateAnswerProgress(answeredPlayers) {
        const progress = document.getElementById('answerProgress');
        progress.innerHTML = '';
        answeredPlayers.forEach(function(player, index) {
            const div = document.createElement('div');
            const isFirst = index === 0 && player.correct;
            div.className = 'progress-item' + (player.correct ? ' answered' : ' wrong');
            const badgeClass = player.correct ? (isFirst ? 'first' : 'correct') : 'incorrect';
            const badgeText = player.correct ? (isFirst ? '1ä½' : 'æ­£è§£') : 'ä¸æ­£è§£';
            div.innerHTML = '<div class="progress-name">' + player.name + '</div>' +
                           '<div class="progress-badge ' + badgeClass + '">' + badgeText + '</div>';
            progress.appendChild(div);
        });
    }

    function startTimer() {
        state.timeLeft = 30;
        const timerEl = document.getElementById('timer');
        timerEl.textContent = state.timeLeft;
        timerEl.classList.remove('warning');
        clearInterval(state.timer);
        state.timer = setInterval(function() {
            state.timeLeft--;
            timerEl.textContent = state.timeLeft;
            if (state.timeLeft <= 10) {
                timerEl.classList.add('warning');
            }
            if (state.timeLeft <= 0) {
                clearInterval(state.timer);
                if (state.isHost) {
                    calculateScores();
                    setTimeout(function() {
                        state.currentRound++;
                        nextQuestion();
                    }, 3000);
                }
            }
        }, 1000);
    }

    function calculateScores() {
        const roomData = storage.get('room_' + state.roomCode);
        const answeredPlayers = roomData.answeredPlayers || [];
        const correctAnswers = answeredPlayers.filter(function(p) {
            return p.correct;
        }).sort(function(a, b) {
            return a.timestamp - b.timestamp;
        });
        
        if (correctAnswers.length > 0) {
            roomData.scores[correctAnswers[0].name] = (roomData.scores[correctAnswers[0].name] || 0) + 2;
            for (let i = 1; i < correctAnswers.length; i++) {
                roomData.scores[correctAnswers[i].name] = (roomData.scores[correctAnswers[i].name] || 0) + 1;
            }
        }
        
        storage.set('room_' + state.roomCode, roomData);
    }

    function updateScoreboard() {
        const scoreList = document.getElementById('scoreList');
        scoreList.innerHTML = '';
        const sortedPlayers = state.players.slice().sort(function(a, b) {
            return (state.scores[b.name] || 0) - (state.scores[a.name] || 0);
        });
        sortedPlayers.forEach(function(player, index) {
            const div = document.createElement('div');
            div.className = 'score-item' + (index === 0 ? ' first' : '');
            const mistakeCount = state.mistakes[player.name] || 0;
            const isEliminated = mistakeCount > state.mistakesAllowed;
            div.innerHTML = '<span class="score-name">' + player.name + (isEliminated ? ' ğŸ’€' : '') + '</span>' +
                           '<span class="score-points">' + (state.scores[player.name] || 0) + 'pt</span>';
            if (mistakeCount > 0 && !isEliminated) {
                const mistakesDiv = document.createElement('div');
                mistakesDiv.className = 'mistakes-info';
                mistakesDiv.textContent = 'ãŠæ‰‹ä»˜ã: ' + mistakeCount + '/' + state.mistakesAllowed;
                div.appendChild(mistakesDiv);
            }
            scoreList.appendChild(div);
        });
    }

    function showResults() {
        if (pollInterval) {
            clearInterval(pollInterval);
            pollInterval = null;
        }
        showScreen('resultsScreen');
        const sortedPlayers = state.players.slice().sort(function(a, b) {
            return (state.scores[b.name] || 0) - (state.scores[a.name] || 0);
        });
        document.getElementById('winnerName').textContent = 'ğŸ‰ ' + sortedPlayers[0].name + ' å„ªå‹! ğŸ‰';
        const finalScores = document.getElementById('finalScores');
        finalScores.innerHTML = '';
        sortedPlayers.forEach(function(player, index) {
            const div = document.createElement('div');
            div.style.cssText = 'font-size: 1.1rem; padding: 0.8rem; margin: 0.4rem 0; background: rgba(255, 255, 255, 0.05); border-radius: 8px;';
            div.innerHTML = '<span style="display: inline-block; width: 35px; height: 35px; background: var(--gold); color: var(--dark-blue); border-radius: 50%; line-height: 35px; margin-right: 0.8rem; font-weight: 700; text-align: center;">' + (index + 1) + '</span>' +
                           player.name + ': ' + (state.scores[player.name] || 0) + 'pt';
            finalScores.appendChild(div);
        });
        playCorrect();
        setTimeout(playCorrect, 300);
        setTimeout(playCorrect, 600);
    }

    function continueGame() {
        const roomData = storage.get('room_' + state.roomCode);
        if (!roomData) {
            alert('ãƒ«ãƒ¼ãƒ ãƒ‡ãƒ¼ã‚¿ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“');
            location.reload();
            return;
        }
        
        roomData.showResults = false;
        roomData.gameStarted = true;
        state.players.forEach(function(p) {
            roomData.scores[p.name] = 0;
            roomData.mistakes[p.name] = 0;
            state.scores[p.name] = 0;
            state.mistakes[p.name] = 0;
        });
        roomData.currentRound = 1;
        roomData.usedQuestions = [];
        state.currentRound = 1;
        state.usedQuestions = [];
        
        storage.set('room_' + state.roomCode, roomData);
        
        showScreen('quizScreen');
        startPolling();
        
        if (state.isHost) {
            setTimeout(function() {
                nextQuestion();
            }, 500);
        }
    }

    function endGame() {
        if (pollInterval) {
            clearInterval(pollInterval);
        }
        location.reload();
    }

    function init() {
        document.getElementById('createRoomBtn').addEventListener('click', createRoom);
        document.getElementById('joinRoomBtn').addEventListener('click', showJoinRoom);
        document.getElementById('backToHomeBtn').addEventListener('click', showHome);
        document.getElementById('joinBtn').addEventListener('click', joinRoom);
        document.getElementById('copyCodeBtn').addEventListener('click', copyRoomCode);
        document.getElementById('startGameBtn').addEventListener('click', startGameFromLobby);
        document.getElementById('buzzerBtn').addEventListener('click', buzzerPressed);
        document.getElementById('continueBtn').addEventListener('click', continueGame);
        document.getElementById('endBtn').addEventListener('click', endGame);
        window.addEventListener('beforeunload', function() {
            if (pollInterval) {
                clearInterval(pollInterval);
            }
        });
    }

    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', init);
    } else {
        init();
    }
})();
    </script>
</body>
</html>
